<!--
  @author   liangxiaoqiong
  @version  1.0
  @date 2021/3/11
  -->
<!-- template 时间组件-->
<script type="x-template" id="date_picker">
  <!--region 模版-->
  <div class="display-align">
    <template v-if="isRelate">
      <el-date-picker
          :size="size"
          class="diy-time-picker"
          v-model="dateRange"
          :type="type"
          value-format="yyyy-MM-dd HH:mm:ss"
          :default-time="['00:00:00', '23:59:59']"
          range-separator=""
          start-placeholder="开始时间"
          end-placeholder="结束时间">
      </el-date-picker>
    </template>
    <template v-else>
      <div class="diy-time-picker no-relate">
        <el-date-picker
          :size="size"
          v-model="info[param[0]]"
          type="datetime"
          value-format="yyyy-MM-dd HH:mm:ss"
          placeholder="开始时间">
        </el-date-picker>
        <el-date-picker
          :size="size"
          v-model="info[param[1]]"
          type="datetime"
          value-format="yyyy-MM-dd HH:mm:ss"
          placeholder="结束时间">
        </el-date-picker>
      </div>
    </template>
    <a class="xxbtn-white ml-10" v-for="val in fastBtnList" @click="timeShortcut(val)">{{ timeTypeText(val) }}</a>
  </div>
  <!--endregion-->
</script>

<!-- JS -->
<script>
  AppUtil.COMPONENTS.DATE_PICKER = {
    template: '#date_picker',
    props: {
      info: Object,
      param: {
        type: Array,
        default: function () {
          return ['start_time', 'end_time']
        }
      }, // 变量名
      fastBtnList: {
        type: Array,
        default: function () {
          return [1, 7, 30, 0]
        }
      },
      size: {
        type: String,
        default: 'mini'
      },
      type: {
        type: String,
        default: 'datetimerange'
      },
      isRelate: {
        type: Boolean,
        default: true // 开始时间，结束时间是否关联选择；=false时，可分开选；=true:时间范围
      }
    },
    data: function () {
      return {
        timeTypeList: [
          {value: 1, label: "今天"},
          {value: 7, label: "近7天"},
          {value: 30, label: "近30天"},
          {value: 0, label: "全部"},
        ]
      }
    },
    computed: {
      dateRange: {
        set: function (val) {
          if (val === '' || val == null) {
            this.info[this.param[0]] = ''
            this.info[this.param[1]] = ''
          } else {
            this.info[this.param[0]] = val[0]
            this.info[this.param[1]] = val[1]
          }
        },
        get: function () {
          if (this.info[this.param[0]] === '') {
            return ''
          }
          return [this.info[this.param[0]], this.info[this.param[1]]]
        }
      },
    },
    mounted: function () {
    },
    methods: {
      //时间快捷键
      timeShortcut: function (type) {
        var time = publicWap.dayToTime(type);
        if (this.isRelate) {
          this.dateRange = time;
        } else {
          this.info[this.param[0]] = time[0]
          this.info[this.param[1]] = time[1]
        }
        event.preventDefault()
      },
      timeTypeText: function (val) {
        var text = '';
        this.timeTypeList.forEach(function (time) {
          if (+time.value === +val) {
            text = time.label;
          }
        })
        return text;
      },
    }
  }
</script>
